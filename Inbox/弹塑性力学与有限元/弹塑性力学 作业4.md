# 弹塑性力学 作业

<center>Deadline: 2022年11月10日, 上课前交</center>

<center>作业采用电子版提交，电子版发送至群作业中</center>

1. For the combined isotropic and kinematic hardening plasticity model, we have:
    - Yield function
        $$
        f(\sigma,q,\alpha) = \vert \sigma -q \vert - (\sigma_Y + K\alpha) \le 0
        $$
        where $q$ denotes to the *back stress*, and $\alpha$ stands for internal hardening variable.

    - Flow rule
        $$
        \dot{\varepsilon}^p = \dot{\gamma} \frac{\partial f}{\partial \sigma} = \dot{\gamma} \mathrm{sign}(\sigma -q)
        $$
    - Hardening laws
        $$
        \dot{\alpha} = \vert \dot{\varepsilon}^p \vert = \dot{\gamma}
        $$
    - Karush-Kuhn-Tucker (KKT) condition
        $$
        \dot{\gamma} \ge 0, \quad f(\sigma,q,\alpha) \le 0, \quad \dot{\gamma}f(\sigma,q,\alpha) = 0
        $$
    - Consistency condition
        $$
        \dot{\gamma} \dot{f}(\sigma,q,\alpha) = 0
        $$

    In a return-mapping algorithm, we would like to update the state variables $\{\sigma_n,q_n,\alpha_n\}$ to $\{\sigma_{n+1},q_{n+1},\alpha_{n+1}\}$ under a given strain increment $\Delta \varepsilon_n$.
    The first step is the trial elastic phase:
    $$
    \left \{
    \begin{split}
        \sigma_{n+1}^{trial} &= \sigma_n + E\Delta \varepsilon_n \\
        \varepsilon_{n+1}^{ptrial} &= \varepsilon_n^p \\
        \alpha_{n+1}^{trial} &= \alpha_n \\
        q_{n+1}^{trial} &= q_n \\
        f_{n+1}^{trial} &= \vert \sigma_{n+1}^{trial} - q_n \vert - (\sigma_Y + K\alpha_n)
    \end{split}
    \right .
    $$
    For $f_{n+1}^{trial} \ge 0$, the return-mapping step for the plastic correction are defined as follows
    $$
    \left \{
    \begin{split}
        \sigma_{n+1} &= \sigma_{n+1}^{trial} - \Delta \gamma E \mathrm{sign}(\sigma_{n+1}-q_{n+1}) \\
        \varepsilon_{n+1}^{p} &= \varepsilon_n^p + \Delta \gamma \mathrm{sign}(\sigma_{n+1}-q_{n+1}) \\
        \alpha_{n+1} &= \alpha_n + \Delta \gamma \\
        q_{n+1} &= q_n + \Delta \gamma H \mathrm{sign}(\sigma_{n+1}-q_{n+1}) \\
        f_{n+1} &= \vert \sigma_{n+1} - q_{n+1} \vert - (\sigma_Y + K \alpha_{n+1})
    \end{split}
    \right .
    $$
    (a) Show the following relations
    $$
    \mathrm{sign}(\sigma_{n+1}-q_{n+1}) = \mathrm{sign}(\sigma_{n+1}^{trial}-q_{n+1}^{trial})
    $$
    $$
    \vert \sigma_{n+1}^{trial} - q_{n+1}^{trial} \vert = \vert \sigma_{n+1} - q_{n+1} \vert + \Delta \gamma(E+H)
    $$
    **Solution**:
    As the $\sigma_{n+1}$, $q_{n+1}$ can be expressed as
    $$
    \left \{
    \begin{split}
        \sigma_{n+1} &= \sigma_{n+1}^{trial} - \Delta \gamma E \mathrm{sign}(\sigma_{n+1}-q_{n+1}) \\
        q_{n+1} &= q_n + \Delta \gamma H \mathrm{sign}(\sigma_{n+1}-q_{n+1}) \\
    \end{split}
    \right .
    $$
    subtracting the above two equations leads to
    $$
    \begin{split}
        \sigma_{n+1}-q_{n+1} &= \sigma_{n+1}^{trial} - q_n - \Delta \gamma (E+H) \mathrm{sign}(\sigma_{n+1}-q_{n+1})\\
        \vert \sigma_{n+1}-q_{n+1} \vert \mathrm{sign}(\sigma_{n+1}-q_{n+1}) &= \vert \sigma_{n+1}^{trial} - q_{n+1}^{trial} \vert \mathrm{sign}(\sigma_{n+1}^{trial}-q_{n+1}^{trial}) - \Delta \gamma (E+H) \mathrm{sign}(\sigma_{n+1}-q_{n+1})
    \end{split}
    $$
    or 
    $$
    (\vert \sigma_{n+1}-q_{n+1} \vert + \Delta \gamma (E+H)) \mathrm{sign}(\sigma_{n+1}-q_{n+1}) = \vert \sigma_{n+1}^{trial} - q_{n+1}^{trial} \vert \mathrm{sign}(\sigma_{n+1}^{trial}-q_{n+1}^{trial})
    $$
    As $E,H>0$, we have
    $$
    \mathrm{sign}(\sigma_{n+1}-q_{n+1}) = \mathrm{sign}(\sigma_{n+1}^{trial}-q_{n+1}^{trial})
    $$
    $$
    \begin{equation}
    \vert \sigma_{n+1}^{trial} - q_{n+1}^{trial} \vert = \vert \sigma_{n+1} - q_{n+1} \vert + \Delta \gamma(E+H)
    \tag{1}
    \end{equation}
    $$
    (b) Use the discrete consistency condition $f_{n+1}=0$ to show the incremental plasticity parameter $\Delta \gamma$ is given by
    $$
    \Delta \gamma = \frac{f_{n+1}^{trial}}{E+H+K}
    $$
    **Solution**:
    Using Eq. ($\ref{1}$) and $\alpha_{n+1} = \alpha_n + \Delta\gamma$, $f_{n+1}$ can be rewritten as
    $$
    \begin{split}
        f_{n+1} &= \vert \sigma_{n+1} - q_{n+1} \vert - (\sigma_Y+K\alpha_{n+1}) \\
                &= \vert \sigma_{n+1}^{trial} - q_{n+1}^{trial} \vert - (\sigma_Y+K\alpha_{n}) - \Delta \gamma(E+H+K) \\
                &= f_{n+1}^{trial} - \Delta \gamma(E+H+K)
    \end{split}
    $$
    Due to the consistency condition $f_{n+1}=0$, we have
    $$
    \Delta \gamma = \frac{f_{n+1}^{trial}}{E+H+K}
    $$
    (c) Show the following relationship holds
    $$
    \frac{\partial \Delta \gamma}{\partial \varepsilon_{n+1}} = \mathrm{sign}(\sigma_{n+1}^{trial}-q_{n+1}^{trial}) \frac{E}{E+H+K}
    $$
    **Solution**:
    $$
    \frac{\partial \Delta \gamma}{\partial \varepsilon_{n+1}} = \frac{\partial f_{n+1}^{trial}}{\partial \varepsilon_{n+1}} \frac{1}{E+H+K} \tag{2}
    $$
    $$
        \frac{\partial f_{n+1}^{trial}}{\partial \varepsilon_{n+1}} = \frac{\partial \sigma_{n+1}^{trial}}{\partial \varepsilon_{n+1}} \mathrm{sign}(\sigma_{n+1}^{trial}-q_{n+1}^{trial}) = E \mathrm{sign}(\sigma_{n+1}^{trial}-q_{n+1}^{trial}) \tag{3}
    $$
    substituting $\ref{3}$ into $\ref{2}$
    $$
    \frac{\partial \Delta \gamma}{\partial \varepsilon_{n+1}} = \frac{E}{E+H+K}\mathrm{sign}(\sigma_{n+1}^{trial}-q_{n+1}^{trial})
    $$
    (d) For $f_{n+1}^{trial} > 0$, show the tangent elastoplastic modulus $E_T$ is
    $$
    E_T = \frac{\partial \sigma_{n+1}}{\partial \varepsilon_{n+1}} = \frac{E(K+H)}{E+K+H}
    $$
    **Solution**:
    $$
    \begin{split}
        E_T &= \frac{\partial \sigma_{n+1}}{\partial \varepsilon_{n+1}} \\
            &= \frac{\partial \sigma_{n+1}^{trial}}{\partial \varepsilon_{n+1}} - \frac{\partial \Delta \gamma}{\partial \varepsilon_{n+1}}E\mathrm{sign}(\sigma_{n+1}-q_{n+1}) \\
            &= E - \frac{E^{2}}{E+H+K} \\
            &= \frac{E(H+K)}{E+H+K} 
    \end{split}
    $$
    
2. Consider an elastoplastic bar with the following yield function
    $$
    f(\sigma,q,r) = \vert \sigma - q \vert - r \le 0
    $$
    where $q$ is the *back stress* and $r$ is the distance between back stress and the yield stresses in tension and compression, $r=\sigma_Y$ initially. A combined isotropic-kinematic hardening can be obtained by setting
    $$
    \dot{r} = \beta H \dot{\gamma}, \quad \dot{q} = (1-\beta) H \dot{\gamma} \mathrm{sign}(\sigma-q), \quad 0\le \beta \le 1
    $$
    (a) For *associative* flow rule, i.e. $\dot{\varepsilon}^p = \dot{\gamma}\frac{\partial f}{\partial \sigma}$, using the consistency condition show that
    $$
    \dot{\gamma} = \mathrm{sign}(\sigma-q) \frac{E}{E+H} \dot{\varepsilon}
    $$
    and determine the final expression for the plastic strain rate $\dot{\varepsilon}^p$ for this combined hardening.
    **Solution**:
    According to consistency condition, we have
    $$
    \begin{split}
        \dot{f} &= \frac{\partial f}{\partial \sigma} \dot{\sigma} + \frac{\partial f}{\partial q} \dot{q} + \frac{\partial f}{\partial r} \dot{r} \\
                &= \mathrm{sign}(\sigma-q)E(\dot{\varepsilon}-\dot{\varepsilon}^p) - (1-\beta)H\dot{\gamma} - \beta H \dot{\gamma} \\
                &= \mathrm{sign}(\sigma-q)E\dot{\varepsilon} - (E+H)\dot{\gamma} \\
                &= 0
    \end{split}
    $$
    equivalently
    $$
    \dot{\gamma} = \mathrm{sign}(\sigma-q) \frac{E}{E+H} \dot{\varepsilon}
    $$

    (b) Consider an initially stress-free bar stretched to $\sigma = 2 \mathrm{MPa}$, and then compressed to $\sigma = -2 \mathrm{MPa}$. Take $\sigma_Y = 1 \mathrm{MPa}$ and $E=H=100 \mathrm{MPa}$. Plot the resulting stress-strain curves for each of the following cases: (1) $\beta = 0$, (2) $\beta = \frac{1}{2}$, (3) $\beta = 1$. 
    **Solution**:
    The stress-strain curves is plotted based upon the following relations
    For $f=|\sigma-q|-r<0$
    $$
    \left \{
    \begin{split}
    &\Delta \sigma = E \Delta \varepsilon \\
    &\Delta \gamma = 0 \\
    &\Delta r = 0 \\
    &\Delta q = 0 
    \end{split}
    \right .
    $$
    For $f=|\sigma-q|-r=0$
    $$
    \left \{
    \begin{split}
    &\Delta \sigma = E (\Delta \varepsilon-\Delta \varepsilon^p) = \frac{EH}{E+H} \Delta \varepsilon \\
    &\Delta \gamma = \mathrm{sign}(\sigma-q) \frac{E}{E+H} \Delta \varepsilon \\
    &\Delta r = \beta H \Delta \gamma \\
    &\Delta q = \mathrm{sign}(\sigma-q)(1-\beta) H \Delta \gamma
    \end{split}
    \right .
    $$

    (1) For $\beta = 0$

    | $n$ | $\sigma_n$(MPa) | $\varepsilon_n$(%) | $\gamma_n$(%) | $r_n$(MPa) | $q_n$(MPa) |
    |-----|-----------------|--------------------|---------------|------------|------------|
    | 1   | 0               | 0                  | 0             | 1          | 0          |
    | 2   | 1               | 0+1=1              | 0             | 1          | 0          |
    | 3   | 1+1=2           | 1+2=3              | 0+1=1         | 1          | 0+1=1      |
    | 4   | 2-2=0           | 3-2=1              | 1             | 1          | 1          |
    | 5   | 0-2=-2          | 1-4=-3             | 1+2=3         | 1          | 1-2=-1     |
    | 6   | -2+2=0          | -3+2=-1            | 3             | 1          | -1         |
    | 7   | 0+2=2           | -1+4=3             | 3+2=5         | 1          | -1+2=1     |

    ![20221115-1](/Users/wujc/note/Excalidraw/20221115-1.png)

    (2) For $\beta = \frac{1}{2}$

    | $n$ | $\sigma_n$(MPa) | $\varepsilon_n$(%) | $\gamma_n$(%) | $r_n$(MPa) | $q_n$(MPa) |
    |-----|-----------------|--------------------|---------------|------------|------------|
    | 1   | 0               | 0                  | 0             | 1          | 0          |
    | 2   | 1               | 0+1=1              | 0             | 1          | 0          |
    | 3   | 1+1=2           | 1+2=3              | 0+1=1         | 1+0.5=1.5  | 0+0.5=0.5  |
    | 4   | 2-3=-1          | 3-3=0              | 1             | 1.5        | 0.5        |
    | 5   | -1-1=-2         | 0-2=-2             | 1+2=3         | 1.5+1=2.5  | 0.5-1=-0.5 |
    | 6   | -2+4=2          | -2+4=2             | 3             | 2.5        | -0.5       |
    | 7   | 2-4=-2          | 2-4=-2             | 3             | 2.5        | -0.5       |

    ![20221115-2](/Users/wujc/note/Excalidraw/20221115-2.png)

    (3) For $\beta = 1$
    
    | $n$ | $\sigma_n$(MPa) | $\varepsilon_n$(%) | $\gamma_n$(%) | $r_n$(MPa) | $q_n$(MPa) |
    |-----|-----------------|--------------------|---------------|------------|------------|
    | 1   | 0               | 0                  | 0             | 1          | 0          |
    | 2   | 1               | 0+1=1              | 0             | 1          | 0          |
    | 3   | 1+1=2           | 1+2=3              | 0+1=1         | 1+1=2      | 0          |
    | 4   | 2-4=-2          | 3-4=-1             | 1             | 2          | 0          |
    | 5   | -2+4=2          | -1+4=3             | 1             | 2          | 0          |

    ![20221115-3](/Users/wujc/note/Excalidraw/20221115-3.png)
